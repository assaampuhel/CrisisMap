<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>CrisisMap AI — Admin</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div class="container admin">
    <header class="admin-top">
      <h1>CrisisMap — Admin</h1>

      <div class="controls">
        <input id="searchInput" placeholder="Search location or description..." />
        <select id="statusFilter" title="Filter incidents by status">
          <option value="">All</option>
          <option value="new">New</option>
          <option value="in_progress">In Progress</option>
          <option value="rescue_dispatched">Rescue Dispatched</option>
          <option value="closed">Closed</option>
        </select>

        <button id="generateBtn" class="btn btn-primary">Generate Dispatch Plan</button>
        <button id="logoutBtn" class="btn btn-ghost">Logout</button>

      </div>
    </header>

    <main>
      <section id="incidents" class="incident-list"></section>
    </main>

    <!-- Detail Modal -->
      <div id="detailModal" class="modal hidden" role="dialog" aria-hidden="true">
        <div class="modal-content">
          <button class="modal-close" id="detailClose">✖</button>

          <div class="modal-grid">
            <div>
              <h2 id="detailTitle">Location</h2>
              <div id="detailSummary" style="display:none;"></div>

              <!-- Reporter -->
              <div style="margin-top:6px; font-size:16px;">
                <div style="padding-bottom: 10px;">
                  <strong>Reported by:</strong> <span id="reporterName">—</span>
                </div>
                <strong>Phone:</strong> <a id="reporterPhoneLink" href="#">—</a>
              </div>

              <div class="meta-row" style="margin-top:10px">
                <div><strong>Severity:</strong> <span id="detailSeverity"></span></div>
                <div><strong>Estimated affected:</strong> <span id="detailPeople"></span></div>
              </div>

              <p style="margin-top:12px"><strong>Description</strong></p>
              <p id="detailDesc"></p>

              <!-- Follow-up questions container -->
              <div id="followUpContainer" style="margin-top:10px"></div>

              <!-- Diagnostics container (only show severity_source now) -->
              <div id="diagnosticsContainer" style="margin-top:8px; color:#666; font-size:12px"></div>

              <label for="statusSelect" style="display:block; margin-top:12px"><strong>Update status</strong></label>
              <select id="statusSelect">
                <option value="new">New</option>
                <option value="in_progress">In Progress</option>
                <option value="rescue_dispatched">Rescue Dispatched</option>
                <option value="closed">Closed</option>
              </select>

              <div style="margin-top:12px">
                <button id="saveStatusBtn" class="btn btn-primary">Save</button>
              </div>
            </div>

            <div>
              <img id="detailImage" alt="Incident photo" style="display:none; border-radius:8px; object-fit:cover; width:100%; max-height:260px;" />
              <iframe id="mapFrame" title="Incident map" style="width:100%; height:260px; border:0; margin-top:12px"></iframe>
            </div>
          </div>
        </div>
      </div>



    <!-- Plan Modal -->
    <div id="planModal" class="modal hidden" role="dialog" aria-hidden="true">
      <div class="modal-content">
        <button class="modal-close" id="planClose">✖</button>
        <h2>Dispatch Action Plan</h2>
        <pre id="planText" class="plan-text"></pre>
        <div id="routeBlock" style="margin-top:10px"></div>
      </div>
    </div>
  </div>

  <script src="dashboard.js"></script>
  <!-- Replace YOUR_GOOGLE_MAPS_API_KEY with your real browser key -->
  <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyA-ycerXN_MAc5A09sy3tPgZaQ7YCYdU54"></script>
</body>
</html>
